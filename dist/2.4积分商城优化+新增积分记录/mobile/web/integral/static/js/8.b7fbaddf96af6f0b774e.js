webpackJsonp([8],{CHge:function(t,e){},uZco:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("ergL"),o=i("Au9i"),a=i("PJh5"),n=i.n(a),l={name:"integral-history",components:{common:s.a},data:function(){return{title:"我的积分",rightTitle:"积分规则",lists:[],virtual_money:0,count:0,isActive:"all",allLoaded:!1,bottomPullText:"上拉加载更多",page:1,isApp:!1}},created:function(){this.judgeApp(),this.allBottom()},methods:{judgeApp:function(){var t=this,e=navigator.userAgent,i=-1!=e.indexOf("iPhone");if(-1!=e.indexOf("damailicai_app")){if(t.isApp=!0,i){try{JIClient.appSetHead({showBack:!0,title:"我的积分",right:"积分记录"})}catch(t){}}else try{JIClient.appSetHead(!0,"我的积分","积分记录")}catch(t){}window.appRight=t.right}else t.isApp=!1},right:function(){location.href="/shop/index#/rule"},allBottom:function(){var t=this;t.getList(t.isActive,t.page,10)},changeActive:function(t){var e=this;e.isActive=t,e.page=1,e.getList(t,e.page,10)},rightClick:function(){this.$router.push("/rule")},getCsrf:function(){this.csrf=document.getElementsByName("csrf-token")[0].content},getList:function(t,e,i){o.Indicator.open({text:"Loading...",spinnerType:"fading-circle"});var s=this,a=new FormData;a.append("page",e),a.append("pageSize",i),a.append("type",t),s.$http.post("/shop/credit-list",a,{headers:{HTTP_X_CSRF_Token:s.csrf,"Content-Type":"multipart/form-data"}}).then(function(t){if("0"==(t=t.data).statusCode){s.virtual_money=t.content.virtual_money,s.count=t.content.count,1==e&&(s.lists=[]);for(var i=0;i<t.content.list.length;i++)s.lists.push(t.content.list[i]);s.$refs.loadmore.onBottomLoaded(),t.content.total<=10*s.page?(s.allLoaded=!0,s.bottomPullText="没有更多了哦",s.$refs.loadmore.bottomText="没有更多了哦"):(s.allLoaded=!1,s.bottomPullText="上拉加载更多",s.$refs.loadmore.bottomText="上拉加载更多",s.page++)}else Object(o.MessageBox)({title:"温馨提示",message:t.message});o.Indicator.close()}).catch(function(t){Object(o.MessageBox)({title:"温馨提示",message:"系统繁忙，请稍后再试！"})})}},filters:{format_timestamp:function(t,e){return n.a.unix(t).format(e||"YYYY-MM-DD HH:mm:ss")},format_date:function(t,e){return n()(t).format(e||"YYYY-MM-DD HH:mm:ss")}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"in-history"}},[t.isApp?t._e():i("common",{attrs:{title:t.title,rightTitle:t.rightTitle},on:{"right-click":t.rightClick}}),t._v(" "),i("nav",{class:["nav",{top:t.isApp}]},[i("ul",{staticClass:"type"},[i("li",{class:{active:"all"==t.isActive},on:{click:function(e){t.changeActive("all")}}},[t._v("全部")]),t._v(" "),i("li",{class:{active:"in"==t.isActive},on:{click:function(e){t.changeActive("in")}}},[t._v("获取记录")]),t._v(" "),i("li",{class:{active:"out"==t.isActive},on:{click:function(e){t.changeActive("out")}}},[t._v("消耗记录")])])]),t._v(" "),i("div",{staticClass:"tab"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"all"==t.isActive,expression:"isActive=='all'"}],staticClass:"num-head all"},[i("span",[t._v("可用积分：")]),t._v(" "),i("span",{domProps:{textContent:t._s(t.virtual_money)}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"in"==t.isActive,expression:"isActive=='in'"}],staticClass:"num-head obtain"},[i("span",[t._v("已获取积分：")]),t._v(" "),i("span",{domProps:{textContent:t._s(t.count)}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"out"==t.isActive,expression:"isActive=='out'"}],staticClass:"num-head consume"},[i("span",[t._v("已消耗积分：")]),t._v(" "),i("span",{domProps:{textContent:t._s(t.count)}})])]),t._v(" "),i("div",{staticClass:"list-box"},[i("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.allBottom,"bottom-all-loaded":t.allLoaded,autoFill:!1,bottomPullText:t.bottomPullText}},[i("ul",t._l(t.lists,function(e,s){return i("li",[i("div",{staticClass:"detail"},[i("p",{domProps:{textContent:t._s(e.remark)}}),t._v(" "),i("p",{staticClass:"time",domProps:{textContent:t._s(t.$options.filters.format_timestamp(e.addtime,"YYYY-MM-DD HH:mm:ss"))}})]),t._v(" "),i("div",[e.extcredits>0?i("p",{staticClass:"add",domProps:{textContent:t._s("+"+e.extcredits)}}):i("p",{staticClass:"reduce",domProps:{textContent:t._s(e.extcredits)}})])])}))])],1),t._v(" "),i("input",{attrs:{type:"hidden",name:"starttime"},domProps:{value:t.$moment("20181205").format("YYYY-MM-DD HH:mm:ss")}})],1)},staticRenderFns:[]};var r=i("VU/8")(l,c,!1,function(t){i("CHge")},null,null);e.default=r.exports}});